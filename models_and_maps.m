/* In this file we have the models and maps between the different models of the curves we have computed*/

P<x,y,z,u,v,w> := ProjectiveSpace(Rationals(),5);


/* Models of X0(121) */


// Galbraith model
I121Gal := [u*w - 2*v*w + 2*u*x - 6*v*x + 2*u*y + 2*v*y + u*z,
u*w + v*w + 2*u*x - 2*v*x + 2*u*y - 10*v*y - 5*u*z + 11*v*z,
-6*u^2 + 6*u*v - 3*v^2 - w^2 + 6*w*x - x^2 - 8*w*y + 10*x*y - 9*y^2 - 4*w*z + 10*x*z,
6*u^2 + 12*u*v + 12*v^2 - 17*w*x - 2*x^2 - 5*w*y + 4*x*y + 14*y^2 - 6*w*z - 7*x*z - 11*y*z,
-9*v^2 - 8*w^2 + w*x + 9*x^2 + 7*w*y - 10*x*y + y^2 - 7*w*z + 27*x*z - 11*y*z,
-6*u^2 - 12*u*v - 12*v^2 - 3*w^2 + 7*w*x - 6*x^2 + 11*w*y + 12*x*y + 10*y^2 + 4*w*z + 17*x*z - 11*y*z - 11*z^2];
X121Gal := Curve(P, I121Gal);
phi := iso<X121Gal -> X121Gal | [-P.1, -P.2, -P.3, P.4, P.5, -P.6],[-P.1, -P.2, -P.3, P.4, P.5, -P.6]>;
G := AutomorphismGroup(X121Gal,[phi]);
C, X121ToC := CurveQuotient(G);
JC := Jacobian(C);
GJC, GJCToJC := MordellWeilGroup(JC);
CQQ := [C![1, -3, 1], C![1, -1, 1], C![0, -1, 1], C![0, 0, 1], C![1, -1, 0], C![1, 0 , 0]];



// Model of X0(121) using Basis function
I121 := [
    -y^2 + x*z - z^2 + 2*u^2 - 4*z*v - 8*u*v - 15*v^2 - 41*y*w - 12*z*w + 32*u*w
        + 5*v*w - 20*w^2,
    -y*z - z^2 + x*u + z*u + u^2 - 3*z*v - 4*u*v - 9*v^2 - 24*y*w - 8*z*w +
        20*u*w + 2*v*w - 11*w^2,
    -z*u + 2*u^2 + x*v - 2*z*v - 3*u*v - 8*v^2 - 20*y*w - 8*z*w + 18*u*w + 3*v*w
        - 2*w^2,
    -v^2 + x*w - 2*y*w - z*w + 2*u*w,
    -z^2 + y*u - z*u + 3*u^2 - 5*z*v - 6*u*v - 14*v^2 - 37*y*w - 11*z*w + 29*u*w
        + 4*v*w - 8*w^2,
    -u^2 + y*v + 3*z*v + 5*u*v + 13*v^2 + 34*y*w + 14*z*w - 31*u*w - 3*v*w +
        12*w^2
];
X121 := Curve(P, I121);


// Model of X0^+(121) with respect to model X121
_<t> := PolynomialRing(Rationals());
X121p := HyperellipticCurve(t^6 - 4*t^4 + 4*t^3 + 8*t^2 - 12*t + 4);



/* Models of XD10 */

// Model of XD10 by Assaf's code
ID10nred := [
    x^2 - 8636/805203*y^2 - 17272/805203*y*z - 8096/805203*y*u -
        17272/805203*y*v + 1388/115029*y*w - 1300216/7246827*z^2 -
        59372/2415609*z*u + 103792/268401*z*v + 791180/7246827*z*w +
        281732/805203*u^2 - 1388/115029*u*v + 50468/2415609*u*w +
        51896/268401*v^2 - 163636/805203*v*w - 1199803/7246827*w^2,
    x*y + 689662/805203*y^2 - 231082/805203*y*z - 18062/805203*y*u -
        231082/805203*y*v + 44357/115029*y*w - 2323108/7246827*z^2 -
        613829/2415609*z*u + 103192/268401*z*v - 5455465/7246827*z*w -
        2548513/805203*u^2 - 44357/115029*u*v + 1171610/2415609*u*w +
        51596/268401*v^2 + 116303/805203*v*w - 582769/7246827*w^2,
    x*z - 159412/805203*y^2 + 1291582/805203*y*z - 305338/805203*y*u -
        318824/805203*y*v - 18920/115029*y*w + 13463675/14493654*z^2 -
        1407736/2415609*z*u - 426613/268401*z*v + 1245637/7246827*z*w +
        5654429/1610406*u^2 + 18920/115029*u*v + 74173/2415609*u*w -
        963415/536802*v^2 + 1049092/805203*v*w + 12176153/14493654*w^2,
    x*u + 42592/805203*y^2 + 85184/805203*y*z + 107806/805203*y*u +
        85184/805203*y*v + 12548/115029*y*w + 33584/7246827*z^2 +
        428572/2415609*z*u - 14624/268401*z*v - 300808/7246827*z*w +
        300740/805203*u^2 - 12548/115029*u*v + 124421/2415609*u*w -
        7312/268401*v^2 + 52184/805203*v*w + 1562/7246827*w^2,
    x*v - 493988/805203*y^2 - 987976/805203*y*z - 799502/805203*y*u +
        622430/805203*y*v - 16720/115029*y*w - 7466867/14493654*z^2 -
        4068944/2415609*z*u + 260557/268401*z*v + 3588632/7246827*z*w -
        388025/1610406*u^2 + 16720/115029*u*v + 1036607/2415609*u*w +
        797359/536802*v^2 - 1044439/805203*v*w - 9808469/14493654*w^2,
    x*w + 21296/805203*y^2 + 42592/805203*y*z - 751300/805203*y*u +
        42592/805203*y*v + 6274/115029*y*w + 16792/7246827*z^2 -
        1396120/2415609*z*u - 7312/268401*z*v - 150404/7246827*z*w +
        150370/805203*u^2 + 223784/115029*u*v - 4366406/2415609*u*w -
        3656/268401*v^2 + 26092/805203*v*w + 781/7246827*w^2
];
XD10nred := Curve(P, ID10nred);



// Reduced model of XD10
ID10 := [u*w - 2*v*w + 2*u*x - 6*v*x + 2*u*y + 2*v*y + u*z,
u*w + v*w + 2*u*x - 2*v*x + 2*u*y - 10*v*y - 5*u*z + 11*v*z,
- 6*u^2 + 6*u*v - 3*v^2 + 11*w^2 - 66*w*x + 11*x^2 + 88*w*y  - 110*x*y + 99*y^2 + 44*w*z - 110*x*z,
6*u^2 + 12*u*v + 12*v^2 + 187*w*x + 22*x^2 + 55*w*y - 44*x*y - 154*y^2 + 66*w*z + 77*x*z  + 121*y*z,
- 9*v^2 + 88*w^2- 11*w*x -99*x^2 - 77*w*y + 110*x*y - 11*y^2 + 77*w*z - 297*x*z  + 121*y*z,
- 6*u^2 - 12*u*v - 12*v^2 + 33*w^2 - 77*w*x + 66*x^2 - 121*w*y - 132*x*y - 110*y^2 - 44*w*z - 187*x*z + 121*y*z  + 121*z^2];
XD10 := Curve(P, ID10);
phi := iso<XD10 -> XD10 | [-P.1, -P.2, -P.3, P.4, P.5, -P.6],[-P.1, -P.2, -P.3, P.4, P.5, -P.6]>;
G := AutomorphismGroup(XD10,[phi]);
CD10, XD10ToC := CurveQuotient(G);




// We do not need the lines below

//////// Maps between models //////////


// The map X0(121) -> X0^+(121)
Xmap := (x - z - 2*u)/(y - 2*u - v + 5*w);
Ymap := (-x^3 + 5*x^2*z + 4*x^2*u - 15*x*y*u + 5*x^2*v + 4*x*y*v + 9*x*z*v - 15*x*u*v -
    44*y*u*v - 21*x^2*w + 17*x*y*w + 93*x*z*w + 45*x*u*w - 187*y*u*w + 103*x*v*w
    + 100*y*v*w + 392*z*v*w + 513*u*v*w + 1131*x*w^2 + 769*y*w^2 + 150*z*w^2 -
    383*u*w^2 - 421*v*w^2 + 565*w^3)/(y - 2*u - v + 5*w)^3;
X121ToX121p := map<X121 -> X121p | [Xmap, Ymap, 1]>;


// The maps X121 <-> X121Gal
polys := [];
X121ToX121Gal := map<X121 -> X121Gal | polys>;
polys := [];
X121GalToX121 := map<X121Gal -> X121 | polys>;


// The maps XD10 <-> X121
PK<x,y,z,u,v,w> := ProjectiveSpace(K,5);
K<r11> := QuadraticField(-11);
X121K := ChangeRing(X121, K);
XD10K := ChangeRing(XD10, K);
polys := [5/44*u^10*v - 53/88*u^9*v^2 - 19/176*r11*u^9*v*w - 225/176*u^8*v^3 +
    69/44*r11*u^8*v^2*w + 4437/352*u^7*v^4 - 6723/704*r11*u^7*v^3*w +
    147/64*r11*u^7*v*w^3 - 645/44*u^6*v^5 + 21871/704*r11*u^6*v^4*w -
    2653/64*r11*u^6*v^2*w^3 - 1341/32*u^5*v^6 - 44603/704*r11*u^5*v^5*w +
    19283/64*r11*u^5*v^3*w^3 + 99*u^4*v^7 + 7365/64*r11*u^4*v^6*w -
    72677/64*r11*u^4*v^4*w^3 - 915/32*u^3*v^8 - 14723/64*r11*u^3*v^7*w +
    151921/64*r11*u^3*v^5*w^3 - 211/4*u^2*v^9 + 21247/64*r11*u^2*v^8*w -
    171919/64*r11*u^2*v^6*w^3 + 685/32*u*v^10 - 14367/64*r11*u*v^9*w +
    91113/64*r11*u*v^7*w^3 - 33/16*v^11 + 2271/64*r11*v^10*w -
    13167/64*r11*v^8*w^3,
    -1/11*u^10*v + 7/176*r11*u^10*w + 15/22*u^9*v^2 - 229/352*r11*u^9*v*w -
    21/44*u^8*v^3 + 3199/704*r11*u^8*v^2*w - 49/64*r11*u^8*w^3 - 795/88*u^7*v^4
    - 24067/1408*r11*u^7*v^3*w + 1981/128*r11*u^7*v*w^3 + 2781/88*u^6*v^5 +
    54135/1408*r11*u^6*v^4*w - 16633/128*r11*u^6*v^2*w^3 - 36*u^5*v^6 -
    93743/1408*r11*u^5*v^5*w + 75449/128*r11*u^5*v^3*w^3 +
    17429/128*r11*u^4*v^6*w - 201113/128*r11*u^4*v^4*w^3 + 183/8*u^3*v^8 -
    33931/128*r11*u^3*v^7*w + 319143/128*r11*u^3*v^5*w^3 - 65/8*u^2*v^9 +
    39335/128*r11*u^2*v^8*w - 287595/128*r11*u^2*v^6*w^3 + 3/4*u*v^10 -
    20707/128*r11*u*v^9*w + 126819/128*r11*u*v^7*w^3 + 2973/128*r11*v^10*w -
    16929/128*r11*v^8*w^3,
    -1/44*u^10*v - 7/88*u^9*v^2 - 25/176*r11*u^9*v*w + 309/176*u^8*v^3 +
    111/88*r11*u^8*v^2*w - 1257/352*u^7*v^4 - 2545/704*r11*u^7*v^3*w +
    49/64*r11*u^7*v*w^3 - 1491/88*u^6*v^5 + 1271/704*r11*u^6*v^4*w -
    917/64*r11*u^6*v^2*w^3 + 2493/32*u^5*v^6 + 3843/704*r11*u^5*v^5*w +
    6941/64*r11*u^5*v^3*w^3 - 99*u^4*v^7 + 929/64*r11*u^4*v^6*w -
    27313/64*r11*u^4*v^4*w^3 + 183/32*u^3*v^8 - 5881/64*r11*u^3*v^7*w +
    59587/64*r11*u^3*v^5*w^3 + 487/8*u^2*v^9 + 9791/64*r11*u^2*v^8*w -
    70191/64*r11*u^2*v^6*w^3 - 709/32*u*v^10 - 6481/64*r11*u*v^9*w +
    38511/64*r11*u*v^7*w^3 + 33/16*v^11 + 1011/64*r11*v^10*w -
    5643/64*r11*v^8*w^3,
    3/44*u^10*v - 67/88*u^9*v^2 + 3/176*r11*u^9*v*w + 393/176*u^8*v^3 +
    27/176*r11*u^8*v^2*w + 1923/352*u^7*v^4 - 2089/704*r11*u^7*v^3*w +
    49/64*r11*u^7*v*w^3 - 534/11*u^6*v^5 + 2575/176*r11*u^6*v^4*w -
    217/16*r11*u^6*v^2*w^3 + 3645/32*u^5*v^6 - 24223/704*r11*u^5*v^5*w +
    6171/64*r11*u^5*v^3*w^3 - 99*u^4*v^7 + 1609/32*r11*u^4*v^6*w -
    11341/32*r11*u^4*v^4*w^3 - 549/32*u^3*v^8 - 4421/64*r11*u^3*v^7*w +
    46167/64*r11*u^3*v^5*w^3 + 69*u^2*v^9 + 179/2*r11*u^2*v^8*w -
    3179/4*r11*u^2*v^6*w^3 - 733/32*u*v^10 - 3943/64*r11*u*v^9*w +
    26301/64*r11*u*v^7*w^3 + 33/16*v^11 + 315/32*r11*v^10*w -
    1881/32*r11*v^8*w^3,
    1/22*u^10*v + 7/176*r11*u^10*w - 15/44*u^9*v^2 - 161/352*r11*u^9*v*w +
    21/88*u^8*v^3 + 1783/704*r11*u^8*v^2*w - 49/64*r11*u^8*w^3 + 795/176*u^7*v^4
    - 14031/1408*r11*u^7*v^3*w + 1785/128*r11*u^7*v*w^3 - 2781/176*u^6*v^5 +
    44735/1408*r11*u^6*v^4*w - 13161/128*r11*u^6*v^2*w^3 + 18*u^5*v^6 -
    108091/1408*r11*u^5*v^5*w + 50765/128*r11*u^5*v^3*w^3 +
    16077/128*r11*u^4*v^6*w - 110385/128*r11*u^4*v^4*w^3 - 183/16*u^3*v^8 -
    16247/128*r11*u^3*v^7*w + 134475/128*r11*u^3*v^5*w^3 + 65/16*u^2*v^9 +
    9103/128*r11*u^2*v^8*w - 84139/128*r11*u^2*v^6*w^3 - 3/8*u*v^10 -
    2335/128*r11*u*v^9*w + 21615/128*r11*u*v^7*w^3 + 213/128*r11*v^10*w -
    1881/128*r11*v^8*w^3,
    -1/22*u^10*v + 15/44*u^9*v^2 + 1/22*r11*u^9*v*w - 21/88*u^8*v^3 -
    15/44*r11*u^8*v^2*w - 795/176*u^7*v^4 + 21/88*r11*u^7*v^3*w +
    2781/176*u^6*v^5 + 795/176*r11*u^6*v^4*w - 18*u^5*v^6 -
    2781/176*r11*u^5*v^5*w + 18*r11*u^4*v^6*w + 183/16*u^3*v^8 - 65/16*u^2*v^9 -
    183/16*r11*u^2*v^8*w + 3/8*u*v^10 + 65/16*r11*u*v^9*w - 3/8*r11*v^10*w
];


// 
Jinvs := [-3375, 8000, -884736, 16581375, -884736000];
