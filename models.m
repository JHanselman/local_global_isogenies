/* In this file we have the models and maps between the different models of the curves we have computed*/

P<x,y,z,u,v,w> := ProjectiveSpace(Rationals(),5);


/* Models of X0(121) */


// Galbraith model
I121_Galbraith := [u*w - 2*v*w + 2*u*x - 6*v*x + 2*u*y + 2*v*y + u*z,
u*w + v*w + 2*u*x - 2*v*x + 2*u*y - 10*v*y - 5*u*z + 11*v*z,
-6*u^2 + 6*u*v - 3*v^2 - w^2 + 6*w*x - x^2 - 8*w*y + 10*x*y - 9*y^2 - 4*w*z + 10*x*z,
6*u^2 + 12*u*v + 12*v^2 - 17*w*x - 2*x^2 - 5*w*y + 4*x*y + 14*y^2 - 6*w*z - 7*x*z - 11*y*z,
-9*v^2 - 8*w^2 + w*x + 9*x^2 + 7*w*y - 10*x*y + y^2 - 7*w*z + 27*x*z - 11*y*z,
-6*u^2 - 12*u*v - 12*v^2 - 3*w^2 + 7*w*x - 6*x^2 + 11*w*y + 12*x*y + 10*y^2 + 4*w*z + 17*x*z - 11*y*z - 11*z^2];
X121_Galbraith := Curve(P, I121_Galbraith);


// Model of X0(121) using Basis function
I121 := [
    -y^2 + x*z - z^2 + 2*u^2 - 4*z*v - 8*u*v - 15*v^2 - 41*y*w - 12*z*w + 32*u*w
        + 5*v*w - 20*w^2,
    -y*z - z^2 + x*u + z*u + u^2 - 3*z*v - 4*u*v - 9*v^2 - 24*y*w - 8*z*w +
        20*u*w + 2*v*w - 11*w^2,
    -z*u + 2*u^2 + x*v - 2*z*v - 3*u*v - 8*v^2 - 20*y*w - 8*z*w + 18*u*w + 3*v*w
        - 2*w^2,
    -v^2 + x*w - 2*y*w - z*w + 2*u*w,
    -z^2 + y*u - z*u + 3*u^2 - 5*z*v - 6*u*v - 14*v^2 - 37*y*w - 11*z*w + 29*u*w
        + 4*v*w - 8*w^2,
    -u^2 + y*v + 3*z*v + 5*u*v + 13*v^2 + 34*y*w + 14*z*w - 31*u*w - 3*v*w +
        12*w^2
];
X121 := Curve(P, I121);


// Model of X0^+(121) with respect to model X121
_<t> := PolynomialRing(Rationals());
X0p := HyperellipticCurve(t^6 - 4*t^4 + 4*t^3 + 8*t^2 - 12*t + 4);



// The map X0(121) -> X0^+(121)
Xmap := (x - z - 2*u)/(y - 2*u - v + 5*w);
Ymap := (-x^3 + 5*x^2*z + 4*x^2*u - 15*x*y*u + 5*x^2*v + 4*x*y*v + 9*x*z*v - 15*x*u*v -
    44*y*u*v - 21*x^2*w + 17*x*y*w + 93*x*z*w + 45*x*u*w - 187*y*u*w + 103*x*v*w
    + 100*y*v*w + 392*z*v*w + 513*u*v*w + 1131*x*w^2 + 769*y*w^2 + 150*z*w^2 -
    383*u*w^2 - 421*v*w^2 + 565*w^3)/(y - 2*u - v + 5*w)^3;
X121ToX0p := map<X121 -> X0p | [Xmap, Ymap, 1]>;



/* Models of XD10 */

// Model of XD10 by Assaf's code
ID10_not_reduced := [
    x^2 - 8636/805203*y^2 - 17272/805203*y*z - 8096/805203*y*u -
        17272/805203*y*v + 1388/115029*y*w - 1300216/7246827*z^2 -
        59372/2415609*z*u + 103792/268401*z*v + 791180/7246827*z*w +
        281732/805203*u^2 - 1388/115029*u*v + 50468/2415609*u*w +
        51896/268401*v^2 - 163636/805203*v*w - 1199803/7246827*w^2,
    x*y + 689662/805203*y^2 - 231082/805203*y*z - 18062/805203*y*u -
        231082/805203*y*v + 44357/115029*y*w - 2323108/7246827*z^2 -
        613829/2415609*z*u + 103192/268401*z*v - 5455465/7246827*z*w -
        2548513/805203*u^2 - 44357/115029*u*v + 1171610/2415609*u*w +
        51596/268401*v^2 + 116303/805203*v*w - 582769/7246827*w^2,
    x*z - 159412/805203*y^2 + 1291582/805203*y*z - 305338/805203*y*u -
        318824/805203*y*v - 18920/115029*y*w + 13463675/14493654*z^2 -
        1407736/2415609*z*u - 426613/268401*z*v + 1245637/7246827*z*w +
        5654429/1610406*u^2 + 18920/115029*u*v + 74173/2415609*u*w -
        963415/536802*v^2 + 1049092/805203*v*w + 12176153/14493654*w^2,
    x*u + 42592/805203*y^2 + 85184/805203*y*z + 107806/805203*y*u +
        85184/805203*y*v + 12548/115029*y*w + 33584/7246827*z^2 +
        428572/2415609*z*u - 14624/268401*z*v - 300808/7246827*z*w +
        300740/805203*u^2 - 12548/115029*u*v + 124421/2415609*u*w -
        7312/268401*v^2 + 52184/805203*v*w + 1562/7246827*w^2,
    x*v - 493988/805203*y^2 - 987976/805203*y*z - 799502/805203*y*u +
        622430/805203*y*v - 16720/115029*y*w - 7466867/14493654*z^2 -
        4068944/2415609*z*u + 260557/268401*z*v + 3588632/7246827*z*w -
        388025/1610406*u^2 + 16720/115029*u*v + 1036607/2415609*u*w +
        797359/536802*v^2 - 1044439/805203*v*w - 9808469/14493654*w^2,
    x*w + 21296/805203*y^2 + 42592/805203*y*z - 751300/805203*y*u +
        42592/805203*y*v + 6274/115029*y*w + 16792/7246827*z^2 -
        1396120/2415609*z*u - 7312/268401*z*v - 150404/7246827*z*w +
        150370/805203*u^2 + 223784/115029*u*v - 4366406/2415609*u*w -
        3656/268401*v^2 + 26092/805203*v*w + 781/7246827*w^2
];
XD10_not_reduced := Curve(P, ID10_not_reduced);



// Reduced model of XD10
ID10 := [u*w - 2*v*w + 2*u*x - 6*v*x + 2*u*y + 2*v*y + u*z,
u*w + v*w + 2*u*x - 2*v*x + 2*u*y - 10*v*y - 5*u*z + 11*v*z,
- 6*u^2 + 6*u*v - 3*v^2 + 11*w^2 - 66*w*x + 11*x^2 + 88*w*y  - 110*x*y + 99*y^2 + 44*w*z - 110*x*z,
6*u^2 + 12*u*v + 12*v^2 + 187*w*x + 22*x^2 + 55*w*y - 44*x*y - 154*y^2 + 66*w*z + 77*x*z  + 121*y*z,
- 9*v^2 + 88*w^2- 11*w*x -99*x^2 - 77*w*y + 110*x*y - 11*y^2 + 77*w*z - 297*x*z  + 121*y*z,
- 6*u^2 - 12*u*v - 12*v^2 + 33*w^2 - 77*w*x + 66*x^2 - 121*w*y - 132*x*y - 110*y^2 - 44*w*z - 187*x*z + 121*y*z  + 121*z^2];
XD10 := Curve(P, ID10);




// tests

K<r11> := QuadraticField(-11);
X := X121_Galbraith;
XK := ChangeRing(X, K);
XDK := ChangeRing(XD10, K);
for f in Polynomials(XK) do
	g := Evaluate(f, [r11*XK.1, r11*XK.2, r11*XK.3, XK.4, XK.5, r11*XK.6]);
	print g;
end for;
//phi := map<XK -> XDK | [r11*XK.1, r11*XK.2, r11*XK.3, XK.4, XK.5, r11*XK.6]>;
phi := map<X121 -> X0p | [Xmap, Ymap, 1]>;
